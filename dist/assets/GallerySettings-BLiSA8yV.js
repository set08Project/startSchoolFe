import{u as _,b as D,r,d0 as M,m as y,e as i,d1 as F,j as e,I as O,k as z,_ as G,cO as R,d2 as E}from"./index-BomD4pl1.js";/* empty css               */import{e as $}from"./index-DG-Wk3lm.js";import{U as B}from"./index-CSzLA8El.js";document.title="School's Gallery";const J=()=>{var p,j,b;const{data:s}=_(),{dataID:c}=D();console.log(c);const[N,d]=r.useState(""),[m,u]=r.useState(""),[S,x]=r.useState(!1),[h,g]=r.useState(""),I=()=>x(!0),f=()=>x(!1),[k,n]=r.useState(!1),C=t=>{const l=t.target.files[0],o=URL.createObjectURL(l);d(l),u(o)};r.useEffect(()=>{let t=setTimeout(()=>{if(m!==""){n(!0);const l=new FormData;l.append("avatar",N),l.append("title",h),M(s==null?void 0:s._id,l).then(o=>{var v,w;o.status===201?(y(`api/view-gallary/${s==null?void 0:s._id}`),i.success("Image Uploaded"),n(!1),d(""),u(""),g(""),f()):(i.error(`${(w=(v=o==null?void 0:o.response)==null?void 0:v.data)==null?void 0:w.message}`),n(!1))})}clearTimeout(t)})},[m]);const{gallary:a}=F(s==null?void 0:s._id);(p=a==null?void 0:a.data)==null||p.map(t=>({src:t.avatar}));const L=t=>{try{E(c,t).then(l=>{console.log(`Deleted gallery ID: ${t}`),y(`api/view-gallary/${s==null?void 0:s._id}`),i.success("Image deleted successfully")})}catch(l){console.log(l),i.error("Failed to delete image")}},U=({isOpen:t,onClose:l,children:o})=>t?e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-lg w-[90%] max-w-sm lg:w-full min-h-[350px] max-h-[450px] flex flex-col items-center justify-between overflow-y-auto",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 bg-gray-600 hover:bg-gray-700 text-white w-7 h-7 flex items-center justify-center rounded-full focus:outline-none","aria-label":"Close",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o]})}):null;return e.jsxs("div",{children:[e.jsx(O,{position:"top-center",reverseOrder:!0}),e.jsxs("div",{className:"w-full bg-white py-[20px] ",children:[e.jsx(z,{name:document.title}),(s==null?void 0:s._id)&&e.jsxs("div",{className:"flex justify-between items-end text-gray-600",children:[e.jsx("div",{className:"mb-5 text-blue-950",children:"Upload School Photos to your custom gallery here"}),e.jsx("button",{className:"mb-3 px-5 py-3 border rounded-md m-2 overflow-hidden flex gap-2 items-center justify-center bg-blue-950 text-white text-[18px] cursor-pointer",onClick:I,children:"Upload"}),e.jsxs(U,{isOpen:S,onClose:f,className:"p-6 bg-white rounded-lg shadow-lg max-w-md mx-auto",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-gray-800",children:"Upload School Image"}),e.jsxs("p",{className:"text-[13px] font-semibold mb-6 text-black text-center",children:["By doing this you will have to upload ",e.jsx("br",{})," your school events images and describe the title of the Image"]}),e.jsx("input",{type:"text",value:h,onChange:t=>g(t.target.value),className:"border border-gray-300 rounded-lg p-3 w-full mb-4 text-gray-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your school image title"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("label",{htmlFor:"gallery-upload",className:"flex items-center justify-center w-full px-6 py-3 border border-transparent rounded-lg bg-blue-950 text-white text-lg cursor-pointer hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:k?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{color:"white",size:20}),e.jsx("span",{children:"Loading..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{size:20}),e.jsx("span",{children:"Upload Image"})]})}),e.jsx("input",{type:"file",id:"gallery-upload",className:"hidden",onChange:C})]})]})]}),e.jsx("div",{className:"p-2 min-h-[400px] mb-10 w-full border flex justify-start items-center transition-all duration-300",children:e.jsx("div",{className:"w-full",children:((j=a==null?void 0:a.data)==null?void 0:j.length)>0?e.jsx("div",{className:"w-full gap-4 grid grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3  ",children:(b=a==null?void 0:a.data)==null?void 0:b.map(t=>e.jsxs("div",{children:[e.jsx(B,{thumbhash:"1QcSHQRnh493V4dIh4eXh1h4kJUI",src:t==null?void 0:t.avatar,autoSizes:!0,className:"w-full h-[300px] rounded-md flex object-cover "}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-500 font-medium pt-4",children:t.title}),e.jsxs("p",{className:"text-gray-400 text-sm pt-4",children:[new Date(t.createdAt).toLocaleString()," "]}),e.jsx("div",{className:"text-[19px] cursor-pointer",onClick:()=>L(t._id),children:e.jsx(R,{})})]})]},t.id))}):e.jsx("div",{children:"no image"})})})]})]})};export{J as default};
