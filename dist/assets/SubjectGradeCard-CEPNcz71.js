import{bP as _,o as $,c8 as C,cH as D,de as M,c4 as P,ci as z,r as u,m as E,j as s,I as F,Q as O,c3 as q,dM as B,b0 as H,c2 as I,t as V,B as Q,_ as J,z as K,df as U,e as W}from"./index-BomD4pl1.js";import{u as X}from"./useQuizHook-C9f4jaC2.js";document.title="View Students for Grading";const Y=({props:t,i:d})=>{var T;const{subjectID:l}=$(),{teacherInfo:n}=_(),{schoolAnnouncement:c}=q(n==null?void 0:n.schoolIDs),{subjectInfo:a}=C(l);B(l);const{oneStudentPerformanceExam:o}=X(l,a==null?void 0:a.examination[(a==null?void 0:a.examination.length)-1]),[m,x]=u.useState(!1);H(n==null?void 0:n.schoolIDs);const[j,r]=u.useState(""),[h,N]=u.useState(""),[R,A]=u.useState(""),[w,G]=u.useState(""),[f,y]=u.useState(""),{gradeData:v}=I(t==null?void 0:t._id);let g=(T=v==null?void 0:v.reportCard)==null?void 0:T.find(i=>i.classInfo===`${a==null?void 0:a.designated} session: ${c==null?void 0:c.presentSession}(${c==null?void 0:c.presentTerm})`),e=g==null?void 0:g.result.find(i=>i.subject===(a==null?void 0:a.subjectTitle));const k=i=>(o==null||o.find(b=>b.studentName===`${i==null?void 0:i.studentFirstName} ${i==null?void 0:i.studentLastName}`),v==null?void 0:v.reportCard),L=()=>{try{x(!0),U(n==null?void 0:n._id,t==null?void 0:t._id,{subject:a==null?void 0:a.subjectTitle,test1:j?parseInt(j):e!=null&&e.test1?e==null?void 0:e.test1:0,test2:h?parseInt(h):e!=null&&e.test2?e==null?void 0:e.test2:0,test3:R?parseInt(R):e!=null&&e.test3?e==null?void 0:e.test3:0,test4:w?parseInt(w):e!=null&&e.test4?e==null?void 0:e.test4:0,exam:f?parseInt(f):e!=null&&e.exam?e==null?void 0:e.exam:0}).then(i=>{x(!1),E(`api/student-report-card/${t==null?void 0:t._id}`),W.success("Grade added")})}catch(i){return i.stack}};return s.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-16 px-4 my-2  overflow-hidden ${d%2===0?"bg-slate-50":"bg-white"}`,children:[s.jsx("div",{className:"w-[100px] border-r font-bold",children:d+1}),s.jsx("div",{className:"w-[250px] flex border-r",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:V}),s.jsxs("div",{className:"w-[180px] ",children:[" ",t==null?void 0:t.studentLastName," ",t==null?void 0:t.studentFirstName]})]})}),s.jsxs("div",{className:"w-[100px] border-r pl-2",children:[e==null?void 0:e.mark,"  -"," ",s.jsx("span",{className:"font-bold text-[12px]",children:e==null?void 0:e.grade})]}),s.jsx("div",{className:"w-[100px] border-r",children:s.jsx(Z,{props:t})}),s.jsx("div",{className:"w-[100px] border-r",children:s.jsx("input",{className:"w-[70px] h-8 outline-none border rounded-md px-2 ",placeholder:`${(e==null?void 0:e.test4)!==void 0?parseInt(e==null?void 0:e.test4):0}`,value:w,onChange:i=>{G(i.target.value)}})}),s.jsx("div",{className:"w-[100px] border-r  ",children:s.jsx("input",{className:"w-[80px] h-8 outline-none border rounded-md px-2 ",placeholder:`${(e==null?void 0:e.exam)!==void 0?parseInt(e==null?void 0:e.exam):0}`,value:f,onChange:i=>{const b=k(t),S=b==null?void 0:b.performanceRating;S&&!isNaN(S)?y((S/100*60).toString()):y(i.target.value)}})}),s.jsx("div",{className:"w-[180px] border-r relative",children:s.jsx(Q,{name:m?"Loading":"Add Score",icon:m&&s.jsx(J,{color:"white",size:12,className:"py-0 my-0 absolute bottom-6 z-10 left-10"}),className:"pl-4 py-3 w-[85%] bg-black text-white  hover:bg-neutral-800 transition-all duration-300",onClick:L})})]})},Z=({props:t})=>{var l,n,c,a,o,m,x,j;const{mainStudentAttendance:d}=K(t==null?void 0:t._id);return s.jsx("div",{children:((n=(l=d==null?void 0:d.data)==null?void 0:l.attendance)==null?void 0:n.filter(r=>r.present===!0).length)/((a=(c=d==null?void 0:d.data)==null?void 0:c.attendance)==null?void 0:a.length)*100?s.jsxs("div",{children:[(((m=(o=d==null?void 0:d.data)==null?void 0:o.attendance)==null?void 0:m.filter(r=>r.present===!0).length)/((j=(x=d==null?void 0:d.data)==null?void 0:x.attendance)==null?void 0:j.length)*100).toFixed(2),"%"]}):s.jsx("p",{children:"0%"})})},se=()=>{var j;const{teacherInfo:t}=_(),{subjectID:d}=$(),{subjectInfo:l}=C(d);D(t==null?void 0:t.schoolIDs);const{viewClasses:n}=M(t==null?void 0:t.schoolIDs);let c=(j=n==null?void 0:n.classRooms)==null?void 0:j.find(r=>{var h;return(h=r==null?void 0:r.classSubjects)==null?void 0:h.find(N=>N===d)});const{oneClass:a}=P(c==null?void 0:c._id),{classStudents:o}=z(a==null?void 0:a._id),m=o==null?void 0:o.students,x=m==null?void 0:m.sort((r,h)=>{var N;return(N=r.studentLastName)==null?void 0:N.localeCompare(h.studentLastName)});return u.useEffect(()=>{E("api/view-classrooms/")},[t,l,n]),s.jsxs("div",{className:"",children:[s.jsx(F,{position:"top-center",reverseOrder:!0}),s.jsx("div",{className:"mb-0"}),s.jsx(O,{name:`Entry ${l==null?void 0:l.subjectTitle} Grades`}),s.jsx("div",{className:"mt-10"}),s.jsx("div",{className:"flex w-full justify-end"}),s.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[s.jsxs("div",{className:"text-[gray] w-[1000px] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",children:[s.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),s.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),s.jsx("div",{className:"w-[100px] border-r",children:"Student's Grade"}),s.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),s.jsxs("div",{className:"w-[100px] border-r",children:["Test",s.jsx("br",{}),"Score"]}),s.jsx("div",{className:"w-[100px] border-r",children:"Examination Score"}),s.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"})]}),s.jsx("div",{className:" w-[1000px] overflow-hidden",children:(x==null?void 0:x.length)>0?s.jsx("div",{children:x==null?void 0:x.map((r,h)=>s.jsx("div",{children:s.jsx(Y,{props:r,i:h})},r))}):s.jsx("div",{children:"No student yet"})})]})]})};export{se as default};
