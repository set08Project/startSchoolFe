import{u as F,bP as I,o as E,c8 as k,cH as M,de as O,c4 as P,ci as q,r as v,m as L,j as s,I as B,Q as H,b0 as V,c2 as Q,t as J,B as K,_ as U,z as W,df as X,e as G}from"./index-C_ozXG6-.js";import{u as Y}from"./useQuizHook-DEDZUAch.js";document.title="View Students for Grading";const Z=({props:t,i,data:r,teacherID:x})=>{var D;const{subjectID:l}=E(),{subjectInfo:a}=k(l),{oneStudentPerformanceExam:c}=Y(l,a==null?void 0:a.examination[(a==null?void 0:a.examination.length)-1]),[m,o]=v.useState(!1),{schoolInfo:d}=V(r==null?void 0:r._id);console.clear(),console.log(r);const[h,j]=v.useState("0"),[u,b]=v.useState("0"),[R,p]=v.useState("0"),[f,C]=v.useState("0"),[g,_]=v.useState("0"),{gradeData:S}=Q(t==null?void 0:t._id);let y=(D=S==null?void 0:S.reportCard)==null?void 0:D.find(n=>{var N,w;return n.classInfo===`${a==null?void 0:a.designated} session: ${d&&((N=d==null?void 0:d.find(T=>T.year===(r==null?void 0:r.presentSession)))==null?void 0:N.year)}(${d&&((w=d==null?void 0:d.find(T=>T.presentTerm===(r==null?void 0:r.presentTerm)))==null?void 0:w.presentTerm)})`}),e=y==null?void 0:y.result.find(n=>n.subject===(a==null?void 0:a.subjectTitle));const $=n=>c==null?void 0:c.find(w=>w.studentName===`${n==null?void 0:n.studentFirstName} ${n==null?void 0:n.studentLastName}`),z=()=>{try{o(!0),X(x.toString(),t==null?void 0:t._id,{subject:a==null?void 0:a.subjectTitle,test1:h?parseInt(h):e!=null&&e.test1?e==null?void 0:e.test1:0,test2:u?parseInt(u):e!=null&&e.test2?e==null?void 0:e.test2:0,test3:R?parseInt(R):e!=null&&e.test3?e==null?void 0:e.test3:0,test4:f?parseInt(f):e!=null&&e.test4?e==null?void 0:e.test4:0,exam:g?parseInt(g):e!=null&&e.exam?e==null?void 0:e.exam:0}).then(n=>{o(!1),n.status===201?(L(`api/student-report-card/${t==null?void 0:t._id}`),G.success("Grade added")):G.error("Grade denied")})}catch(n){return n.stack}};return s.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-16 px-4 my-2  overflow-hidden ${i%2===0?"bg-slate-50":"bg-white"}`,children:[s.jsx("div",{className:"w-[100px] border-r font-bold",children:i+1}),s.jsx("div",{className:"w-[250px] flex border-r",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:J}),s.jsxs("div",{className:"w-[180px] ",children:[" ",t==null?void 0:t.studentLastName," ",t==null?void 0:t.studentFirstName]})]})}),s.jsxs("div",{className:"w-[100px] border-r pl-2",children:[e==null?void 0:e.mark," -"," ",s.jsx("span",{className:"font-bold text-[12px]",children:e==null?void 0:e.grade})]}),s.jsx("div",{className:"w-[100px] border-r",children:s.jsx(A,{props:t})}),s.jsx("div",{className:"w-[100px] border-r",children:s.jsx("input",{className:"w-[70px] h-8 outline-none border rounded-md px-2 ",placeholder:`${(e==null?void 0:e.test4)!==void 0?e==null?void 0:e.test4:0}`,value:f,onChange:n=>{C(n.target.value)}})}),s.jsx("div",{className:"w-[100px] border-r  ",children:s.jsx("input",{className:"w-[80px] h-8 outline-none border rounded-md px-2 ",placeholder:`${(e==null?void 0:e.exam)!==void 0?e==null?void 0:e.exam:0}`,value:g,onChange:n=>{var N;$(t)?_((((N=$(t))==null?void 0:N.performanceRating)/100*60).toString()):_(n.target.value)}})}),s.jsx("div",{className:"w-[180px] border-r relative",children:s.jsx(K,{name:m?"Loading":"Add Score",icon:m&&s.jsx(U,{color:"white",size:12,className:"py-0 my-0 absolute bottom-6 z-10 left-10"}),className:"pl-4 py-3 w-[85%] bg-black text-white  hover:bg-neutral-800 transition-all duration-300",onClick:z})})]})},A=({props:t})=>{var r,x,l,a,c,m,o,d;const{mainStudentAttendance:i}=W(t==null?void 0:t._id);return s.jsx("div",{children:((x=(r=i==null?void 0:i.data)==null?void 0:r.attendance)==null?void 0:x.filter(h=>h.present===!0).length)/((a=(l=i==null?void 0:i.data)==null?void 0:l.attendance)==null?void 0:a.length)*100?s.jsxs("div",{children:[(((m=(c=i==null?void 0:i.data)==null?void 0:c.attendance)==null?void 0:m.filter(h=>h.present===!0).length)/((d=(o=i==null?void 0:i.data)==null?void 0:o.attendance)==null?void 0:d.length)*100).toFixed(2),"%"]}):s.jsx("p",{children:"0%"})})},te=()=>{var h;const{data:t}=F(),{teacherInfo:i}=I(),{subjectID:r}=E(),{subjectInfo:x}=k(r);M(x==null?void 0:x.subjectClassID);const{viewClasses:l}=O(t==null?void 0:t._id);let a=(h=l==null?void 0:l.classRooms)==null?void 0:h.find(j=>{var u;return(u=j==null?void 0:j.classSubjects)==null?void 0:u.find(b=>b===r)});const{oneClass:c}=P(a==null?void 0:a._id),{classStudents:m}=q(c==null?void 0:c._id),o=m==null?void 0:m.students,d=o==null?void 0:o.sort((j,u)=>{var b;return(b=j.studentLastName)==null?void 0:b.localeCompare(u.studentLastName)});return v.useEffect(()=>{L("api/view-classrooms/")},[i,x,l]),s.jsxs("div",{className:"",children:[s.jsx(B,{position:"top-center",reverseOrder:!0}),s.jsx("div",{className:"mb-0"}),s.jsx(H,{name:`Entry ${x==null?void 0:x.subjectTitle} Grades`}),s.jsx("div",{className:"mt-10"}),s.jsx("div",{className:"flex w-full justify-end"}),s.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[s.jsxs("div",{className:"text-[gray] w-[1000px] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",children:[s.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),s.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),s.jsx("div",{className:"w-[100px] border-r",children:"Student's Grade"}),s.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),s.jsxs("div",{className:"w-[100px] border-r",children:["Test",s.jsx("br",{}),"Score"]}),s.jsx("div",{className:"w-[100px] border-r",children:"Examination Score"}),s.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"})]}),s.jsx("div",{className:" w-[1000px] overflow-hidden",children:(d==null?void 0:d.length)>0?s.jsx("div",{children:d==null?void 0:d.map((j,u)=>s.jsx("div",{children:s.jsx(Z,{props:j,i:u,data:t,teacherID:c==null?void 0:c.teacherID})},j))}):s.jsx("div",{children:"No student yet"})})]})]})};export{te as default};
