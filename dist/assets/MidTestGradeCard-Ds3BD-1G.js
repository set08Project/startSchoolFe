import{bP as G,o as L,c8 as M,cH as O,de as P,c4 as z,ci as q,dL as V,r as v,m as k,j as t,I as B,Q as H,dM as I,b0 as D,c2 as K,t as Q,B as U,_ as J,z as W,dN as X,e as Y}from"./index-BomD4pl1.js";import{u as Z}from"./useQuizHook-C9f4jaC2.js";document.title="View Students for Grading";const A=({props:e,i:n,data:r})=>{var _,E;const{subjectID:x,quizID:N}=L(),{teacherInfo:c}=G(),{subjectInfo:a}=M(x);I(x);const{oneStudentPerformanceExam:m}=Z(x,a==null?void 0:a.examination[(a==null?void 0:a.examination.length)-1]),[o,u]=v.useState(!1),{schoolInfo:l}=D(c==null?void 0:c.schoolIDs);v.useState("");const[f,h]=v.useState(""),[j,b]=v.useState(""),[$,ee]=v.useState(""),[te,T]=v.useState(""),{gradeData:w}=K(e==null?void 0:e._id);console.log("result LOOKUP: ",w);let R=(_=w==null?void 0:w.reportCard)==null?void 0:_.find(d=>{var y,g;return d.classInfo===`${a==null?void 0:a.designated} session: ${(y=l[0])==null?void 0:y.year}(${(g=l[0])==null?void 0:g.presentTerm})`}),s=R==null?void 0:R.result.find(d=>d.subject===(a==null?void 0:a.subjectTitle));const C=d=>m==null?void 0:m.find(g=>g.studentName===`${d==null?void 0:d.studentFirstName} ${d==null?void 0:d.studentLastName}`);let S=(E=r==null?void 0:r.find(d=>d.studentName===`${e==null?void 0:e.studentFirstName} ${e==null?void 0:e.studentLastName}`))==null?void 0:E.performanceRating;const i=r==null?void 0:r.find(d=>d.studentName===`${e==null?void 0:e.studentFirstName} ${e==null?void 0:e.studentLastName}`),F=()=>{try{u(!0),X(c==null?void 0:c._id,e==null?void 0:e._id,{subject:a==null?void 0:a.subjectTitle,test2:f?parseInt(f):s!=null&&s.test2?s==null?void 0:s.test2:0,test3:j?parseInt(j):s!=null&&s.test3?s==null?void 0:s.test3:0,test4:$?parseInt($):s!=null&&s.test4?s==null?void 0:s.test4:0,exam:i!=null&&i.performanceRating?i==null?void 0:i.performanceRating:0}).then(d=>{u(!1),k(`api/student-report-card/${e==null?void 0:e._id}`),Y.success("Grade added")})}catch(d){return d.stack}};return t.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-16 px-4 my-2  overflow-hidden ${n%2===0?"bg-slate-50":"bg-white"}`,children:[t.jsx("div",{className:"w-[100px] border-r font-bold",children:n+1}),t.jsx("div",{className:"w-[250px] flex border-r",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:Q}),t.jsxs("div",{className:"w-[180px] ",children:[" ",e==null?void 0:e.studentFirstName," ",e==null?void 0:e.studentLastName]})]})}),t.jsxs("div",{className:"w-[100px] border-r pl-2",children:[i!=null&&i.performanceRating?i==null?void 0:i.performanceRating:0," /100 -"," ",t.jsx("span",{className:"font-bold text-[12px]",children:i==null?void 0:i.studentGrade})]}),t.jsx("div",{className:"w-[100px] border-r",children:t.jsx(p,{props:e})}),t.jsx("div",{className:"w-[100px] border-r  ",children:t.jsx("input",{className:"w-[80px] h-8 outline-none border rounded-md px-2 ",placeholder:`${(s==null?void 0:s.exam)!==void 0?s==null?void 0:s.exam:0}`,value:S,onChange:d=>{C(e)?T(S):T(d.target.value)},defaultChecked:S,readOnly:!0})}),t.jsx("div",{className:"w-[180px] border-r relative",children:t.jsx(U,{name:o?"Loading":"APPROVE",icon:o&&t.jsx(J,{color:"white",size:12,className:"py-0 my-0 absolute bottom-6 z-10 left-10"}),className:"pl-4 py-3 w-[85%] bg-black text-white  hover:bg-neutral-800 transition-all duration-300",onClick:F})})]})},p=({props:e})=>{var r,x,N,c,a,m,o,u;const{mainStudentAttendance:n}=W(e==null?void 0:e._id);return t.jsx("div",{children:((x=(r=n==null?void 0:n.data)==null?void 0:r.attendance)==null?void 0:x.filter(l=>l.present===!0).length)/((c=(N=n==null?void 0:n.data)==null?void 0:N.attendance)==null?void 0:c.length)*100?t.jsxs("div",{children:[(((m=(a=n==null?void 0:n.data)==null?void 0:a.attendance)==null?void 0:m.filter(l=>l.present===!0).length)/((u=(o=n==null?void 0:n.data)==null?void 0:o.attendance)==null?void 0:u.length)*100).toFixed(2),"%"]}):t.jsx("p",{children:"0%"})})},de=()=>{var f;const{teacherInfo:e}=G(),{subjectID:n,quizID:r}=L(),{subjectInfo:x}=M(n);O(e==null?void 0:e.schoolIDs);const{viewClasses:N}=P(e==null?void 0:e.schoolIDs);let c=(f=N==null?void 0:N.classRooms)==null?void 0:f.find(h=>{var j;return(j=h==null?void 0:h.classSubjects)==null?void 0:j.find(b=>b===n)});const{oneClass:a}=z(c==null?void 0:c._id),{classStudents:m}=q(a==null?void 0:a._id),{midTestPerformance:o}=V(r),u=m==null?void 0:m.students,l=u==null?void 0:u.sort((h,j)=>{var b;return(b=h.studentFirstName)==null?void 0:b.localeCompare(j.studentFirstName)});return v.useEffect(()=>{k("api/view-classrooms/")},[e,x,N]),t.jsxs("div",{className:"",children:[t.jsx(B,{position:"top-center",reverseOrder:!0}),t.jsx("div",{className:"mb-0"}),t.jsx(H,{name:`Entry ${x==null?void 0:x.subjectTitle} Grades`}),t.jsx("div",{className:"mt-10"}),t.jsx("div",{className:"flex w-full justify-end"}),t.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[t.jsxs("div",{className:"text-[gray] w-[900px] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",children:[t.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),t.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),t.jsx("div",{className:"w-[100px] border-r",children:"Student's Grade"}),t.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),t.jsx("div",{className:"w-[100px] border-r",children:"Mid Test Examination Score"}),t.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"})]}),t.jsx("div",{className:" w-[900px] overflow-hidden",children:(l==null?void 0:l.length)>0?t.jsx("div",{children:l==null?void 0:l.map((h,j)=>t.jsx("div",{children:t.jsx(A,{props:h,i:j,data:o==null?void 0:o.performance})},h))}):t.jsx("div",{children:"No student yet"})})]})]})};export{de as default};
