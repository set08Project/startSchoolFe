import{aT as $,o as N,c4 as w,bQ as f,ci as g,c5 as u,r as v,j as e,I as k,Q as _,aq as p,cj as C,e as b,Y as A,u as T,c2 as R,b0 as S,t as E,B as I,ck as G,m as B,z as M}from"./index-BomD4pl1.js";import{d as P,C as q}from"./ckeditor-bZT2XsXW.js";document.title="View Students Grades";const z=({props:s,el:c})=>{var d,j;const{gradeData:l}=R(s==null?void 0:s._id),{data:i}=T(),{schoolInfo:t}=S(s==null?void 0:s.schoolIDs),{classID:r}=N();w(r);const{state:m}=f();u(m==null?void 0:m._id);let a=(j=(d=l==null?void 0:l.reportCard.find(n=>{var o,x;return n.classInfo===`${s==null?void 0:s.classAssigned} session: ${(o=t==null?void 0:t.find(h=>(h==null?void 0:h.year)===(i==null?void 0:i.presentSession)))==null?void 0:o.year}(${(x=t==null?void 0:t.find(h=>(h==null?void 0:h.presentTerm)===(i==null?void 0:i.presentTerm)))==null?void 0:x.presentTerm})`}))==null?void 0:d.result)==null?void 0:j.find(n=>n.subject===(c==null?void 0:c.subjectTitle));return e.jsxs("div",{className:"w-[200px] border-r-2 border-blue-950 ",children:[e.jsx("div",{children:e.jsxs("div",{className:"w-[260px] ",children:[e.jsx("p",{className:"pl-1 font-bold text-[12px]",children:a!=null&&a.subject?a==null?void 0:a.subject:"Have't Entered"}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[10px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:"Test"}),e.jsx("p",{className:"w-[35px] border-r",children:"Exam"}),e.jsx("p",{className:"w-[35px] ",children:"Total"}),e.jsx("p",{className:"w-[35px] ",children:"Grade"})]})]})}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[12px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:a!=null&&a.test4?a==null?void 0:a.test4:0}),e.jsx("p",{className:"w-[35px] border-r",children:a!=null&&a.exam?a==null?void 0:a.exam:0}),e.jsx("p",{className:"w-[35px] font-bold border-r",children:a!=null&&a.mark?a==null?void 0:a.mark:0}),e.jsx("p",{className:"w-[35px] font-bold",children:a!=null&&a.grade?a==null?void 0:a.grade:"Nill"})]})]})},F=({props:s,i:c})=>{var j;const{classID:l}=N(),{data:i}=T(),{gradeData:t}=R(s==null?void 0:s._id),{oneClass:r}=w(l),{subjectData:m}=u(r==null?void 0:r._id);g(r==null?void 0:r._id);const{schoolInfo:a}=S(s==null?void 0:s.schoolIDs);let d=t==null?void 0:t.reportCard.find(n=>{var o,x;return n.classInfo===`${s==null?void 0:s.classAssigned} session: ${(o=a==null?void 0:a.find(h=>h.presentTerm===(r==null?void 0:r.presentTerm)))==null?void 0:o.year}(${(x=a==null?void 0:a.find(h=>h.presentTerm===(r==null?void 0:r.presentTerm)))==null?void 0:x.presentTerm})`});return v.useState(`${d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:""}`),e.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-28 px-4 my-2  overflow-hidden ${c%2===0?"bg-slate-50":"bg-white"}`,children:[e.jsx("div",{className:"w-[100px] border-r font-bold",children:c+1}),e.jsx("div",{className:"w-[250px] flex border-r",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:s!=null&&s.avatar?s==null?void 0:s.avatar:E}),e.jsxs("div",{className:"w-[180px] ",children:[" ",s==null?void 0:s.studentFirstName," ",s==null?void 0:s.studentLastName]})]})}),e.jsx("div",{className:"w-[100px] border-r",children:e.jsx(O,{props:s})}),e.jsx("div",{className:`w-[${(m==null?void 0:m.classSubjects.length)*290}px]  border-r items-center flex`,children:e.jsx("div",{className:"flex gap-4 ",children:(j=p.sortBy(m==null?void 0:m.classSubjects,"subjectTitle"))==null?void 0:j.map(n=>e.jsx(z,{props:s,el:n}))})}),e.jsx("div",{className:"w-[100px] border-r ",children:d==null?void 0:d.points}),e.jsx("div",{className:"w-[100px] border-r",children:d==null?void 0:d.grade}),e.jsx("div",{className:"w-[300px] border-r",children:d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:"No Comment Yet"}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx(I,{name:d!=null&&d.approve?"Result Approved":"Approve Result",className:`pl-4 py-3 w-[85%]  text-white ${d!=null&&d.approve?"bg-black hover:bg-neutral-800 ":"bg-red-500 hover:bg-red-600 "} transition-all duration-300`,onClick:()=>{G(i==null?void 0:i._id,s==null?void 0:s._id,d==null?void 0:d.adminComment).then(n=>{var o,x;n.status===201?(B(`api/student-report-card/${s==null?void 0:s._id}`),b.success("Report Card Report Noted")):b.error(`${(x=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:x.message}`)})}})}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx("p",{className:"w-[115px] uppercase",children:d!=null&&d.approve?"Approved":"Not yet Approve"})})]})},O=({props:s})=>{var l,i,t,r,m,a,d,j;const{mainStudentAttendance:c}=M(s==null?void 0:s._id);return e.jsx("div",{children:((i=(l=c==null?void 0:c.data)==null?void 0:l.attendance)==null?void 0:i.filter(n=>n.present===!0).length)/((r=(t=c==null?void 0:c.data)==null?void 0:t.attendance)==null?void 0:r.length)*100?e.jsxs("div",{children:[(((a=(m=c==null?void 0:c.data)==null?void 0:m.attendance)==null?void 0:a.filter(n=>n.present===!0).length)/((j=(d=c==null?void 0:c.data)==null?void 0:d.attendance)==null?void 0:j.length)*100).toFixed(2),"%"]}):e.jsx("p",{children:"0%"})})},H=({props:s})=>e.jsx("div",{className:"w-[200px] border-r ",children:e.jsx("p",{children:"Subject Offered"})}),Y=()=>{var j,n,o;const s=$(),{classID:c}=N(),{oneClass:l}=w(c);f(l==null?void 0:l.className);const{classStudents:i}=g(l==null?void 0:l._id),{subjectData:t}=u(l==null?void 0:l._id);v.useState([]);const[r,m]=v.useState(""),[a,d]=v.useState(!1);return e.jsxs("div",{className:"",children:[e.jsx(k,{position:"top-center",reverseOrder:!0}),e.jsx("div",{className:"mb-0"}),e.jsx(_,{name:"Admin's Report-card Remark and Approval"}),e.jsx("div",{className:"mt-10"}),e.jsx("div",{className:"flex w-full justify-end"}),e.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[e.jsxs("div",{className:"text-[gray] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",style:{width:`${1200+(t==null?void 0:t.classSubjects.length)*300}px`},children:[e.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),e.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),e.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),e.jsx("div",{className:`w-[${(t==null?void 0:t.classSubjects.length)*290}px] border-r`,children:e.jsx("div",{className:" flex ",children:e.jsx("div",{className:"flex gap-4",children:(j=p.sortBy(t==null?void 0:t.classSubjects,"subjectTitle"))==null?void 0:j.map(x=>e.jsx(H,{props:x}))})})}),e.jsx("div",{className:"w-[100px] border-r",children:"Total Points"}),e.jsx("div",{className:"w-[100px] border-r",children:"Grade"}),e.jsx("div",{className:"w-[300px] border-r",children:"Class Teacher's Comment"}),e.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx("p",{className:"w-[35px] ",children:"Approve"})})]}),e.jsx("div",{className:" overflow-hidde",style:{width:`${1200+(t==null?void 0:t.classSubjects.length)*300}px`},children:((n=i==null?void 0:i.students)==null?void 0:n.length)>0?e.jsx("div",{children:(o=i==null?void 0:i.students)==null?void 0:o.map((x,h)=>e.jsx("div",{children:e.jsx(F,{props:x,i:h})},x))}):e.jsx("div",{children:"No student yet"})})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("p",{className:"text-blue-800 mt-0 font-[500] text-[30px] capitalize",children:"General Class Remark"}),e.jsx("p",{className:"mt-5 mb-2",children:"Please Give a general class remark to approve this result"}),e.jsx("div",{className:"w-full h-[300px] border rounded-md resize-none p-2",children:e.jsx(P.CKEditor,{editor:q,onChange:(x,h)=>{const y=h.getData();m(y)}})}),r?e.jsx("button",{className:`btn btn-wide ${a?"bg-neutral-800":"bg-blue-950"} text-white mt-3 hover:bg-blue-900`,onClick:()=>{d(!0),C(c,r).then(x=>{x.status===200&&(b.success("Result will be Published in a minute time"),s("/dashboard"))}).finally(()=>{d(!1)})},children:a?e.jsx("p",{children:e.jsx(A,{className:"animate-spin text-[20px]"})}):"Result Approved"}):e.jsx("button",{className:"btn  bg-blue-950 text-white mt-8 hover:bg-blue-900 h-[55px] uppercase",children:"Input Remark and Result Approved"})]})]})};export{Y as default};
