import{r as rt,j as At}from"./index-Dr9ZTIop.js";const ot=typeof window>"u",_t=!ot&&"loading"in HTMLImageElement.prototype,pt=!ot&&(!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent));function yt(t,e=document){return typeof t=="string"?[...e.querySelectorAll(t)]:t instanceof Element?[t]:[...t]}function bt(t,e){let n,r;return t>=1?(n=e,r=Math.round(e/t)):(n=Math.round(e*t),r=e),{width:n,height:r}}function Et(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=typeof Buffer<"u"?Buffer.from(e,"base64"):Uint8Array.from(atob(e),r=>r.charCodeAt(0));return new Uint8Array(n)}function ht(t,e){let n;return function(...r){n&&clearTimeout(n),n=setTimeout(()=>{n=void 0,t(...r)},e)}}/**
 * Encodes an RGBA image to a PNG data URI. RGB should not be premultiplied by A.
 *
 * @remarks
 * This is optimized for speed and simplicity and does not optimize for size
 * at all. This doesn't do any compression (all values are stored uncompressed).
 *
 * @see https://github.com/evanw/thumbhash
 * @author Evan Wallace
 * @license MIT
 */function ct(t,e,n){const r=t*4+1,c=6+e*(5+r),o=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,t>>8,t&255,0,0,e>>8,e&255,8,6,0,0,0,0,0,0,0,c>>>24,c>>16&255,c>>8&255,c&255,73,68,65,84,120,1],f=[0,498536548,997073096,651767980,1994146192,1802195444,1303535960,1342533948,-306674912,-267414716,-690576408,-882789492,-1687895376,-2032938284,-1609899400,-1111625188];let s=1,a=0;for(let d=0,u=0,l=r-1;d<e;d++,l+=r-1)for(o.push(d+1<e?0:1,r&255,r>>8,~r&255,r>>8^255,0),a=(a+s)%65521;u<l;u++){const p=n[u]&255;o.push(p),s=(s+p)%65521,a=(a+s)%65521}o.push(a>>8,a&255,s>>8,s&255,0,0,0,0,0,0,0,0,73,69,78,68,174,66,96,130);for(let[d,u]of[[12,29],[37,41+c]]){let l=-1;for(let p=d;p<u;p++)l^=o[p],l=l>>>4^f[l&15],l=l>>>4^f[l&15];l=~l,o[u++]=l>>>24,o[u++]=l>>16&255,o[u++]=l>>8&255,o[u++]=l&255}return`data:image/png;base64,${typeof Buffer<"u"?Buffer.from(new Uint8Array(o)).toString("base64"):btoa(String.fromCharCode(...o))}`}const X=32,wt="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",gt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~",Z=(t,e,n)=>{let r=0;for(;e<n;)r*=83,r+=gt.indexOf(t[e++]);return r},at=Math.pow,H=Math.PI,xt=H*2,lt=3294.6,it=269.025,Lt=t=>t>10.31475?at(t/it+.052132,2.4):t/lt,Q=t=>~~(t>1227e-8?it*at(t,.416666)-13.025:t*lt+1),D=t=>(t<0?-1:1)*t*t,nt=t=>{for(t+=H/2;t>H;)t-=xt;const e=1.27323954*t-.405284735*D(t);return .225*(D(e)-e)+e};function Ct(t){const e=Z(t,2,6);return[e>>16,e>>8&255,e&255]}function Gt(t,e,n,r){const c=Z(t,0,1),o=c%9+1,f=~~(c/9)+1,s=o*f;let a=0,A=0,d=0,u=0,l=0,p=0,B=0,g=0,U=0,b=0,x=0,I=0,R=0,L=0;const w=(Z(t,1,2)+1)/13446*(r|1),E=new Float64Array(s*3),k=Ct(t);for(a=0;a<3;a++)E[a]=Lt(k[a]);for(a=1;a<s;a++)L=Z(t,4+a*2,6+a*2),E[a*3]=D(~~(L/(19*19))-9)*w,E[a*3+1]=D(~~(L/19)%19-9)*w,E[a*3+2]=D(L%19-9)*w;const T=e*4,C=new Uint8ClampedArray(T*n);for(u=0;u<n;u++)for(I=H*u/n,d=0;d<e;d++){for(l=0,p=0,B=0,R=H*d/e,A=0;A<f;A++)for(U=nt(I*A),a=0;a<o;a++)g=nt(R*a)*U,b=(a+A*o)*3,l+=E[b]*g,p+=E[b+1]*g,B+=E[b+2]*g;x=4*d+u*T,C[x]=Q(l),C[x+1]=Q(p),C[x+2]=Q(B),C[x+3]=255}return C}function Ut(t,{ratio:e=1,size:n=X}={}){const{width:r,height:c}=bt(e,n),o=Gt(t,r,c);return ct(r,c,o)}function mt(t){let{PI:e,min:n,max:r,cos:c,round:o}=Math,f=t[0]|t[1]<<8|t[2]<<16,s=t[3]|t[4]<<8,a=(f&63)/63,A=(f>>6&63)/31.5-1,d=(f>>12&63)/31.5-1,u=(f>>18&31)/31,l=f>>23,p=(s>>3&63)/63,B=(s>>9&63)/63,g=s>>15,U=r(3,g?l?5:7:s&7),b=r(3,g?s&7:l?5:7),x=l?(t[5]&15)/15:1,I=(t[5]>>4)/15,R=l?6:5,L=0,w=(z,h,O)=>{let m=[];for(let G=0;G<h;G++)for(let N=G?0:1;N*h<z*(h-G);N++)m.push(((t[R+(L>>1)]>>((L++&1)<<2)&15)/7.5-1)*O);return m},E=w(U,b,u),k=w(3,3,p*1.25),T=w(3,3,B*1.25),C=l&&w(5,5,I),S=Nt(t),M=o(S>1?32:32*S),q=o(S>1?32/S:32),v=new Uint8Array(M*q*4),Y=[],j=[];for(let z=0,h=0;z<q;z++)for(let O=0;O<M;O++,h+=4){let m=a,G=A,N=d,J=x;for(let i=0,_=r(U,l?5:3);i<_;i++)Y[i]=c(e/M*(O+.5)*i);for(let i=0,_=r(b,l?5:3);i<_;i++)j[i]=c(e/q*(z+.5)*i);for(let i=0,_=0;i<b;i++)for(let y=i?0:1,P=j[i]*2;y*b<U*(b-i);y++,_++)m+=E[_]*Y[y]*P;for(let i=0,_=0;i<3;i++)for(let y=i?0:1,P=j[i]*2;y<3-i;y++,_++){let et=Y[y]*P;G+=k[_]*et,N+=T[_]*et}if(l)for(let i=0,_=0;i<5;i++)for(let y=i?0:1,P=j[i]*2;y<5-i;y++,_++)J+=C[_]*Y[y]*P;let K=m-2/3*G,tt=(3*m-K+N)/2,dt=tt-N;v[h]=r(0,255*n(1,tt)),v[h+1]=r(0,255*n(1,dt)),v[h+2]=r(0,255*n(1,K)),v[h+3]=r(0,255*n(1,J))}return{w:M,h:q,rgba:v}}function Nt(t){let e=t[3],n=t[2]&128,r=t[4]&128,c=r?n?5:7:e&7,o=r?e&7:n?5:7;return c/o}function Bt(t){const{w:e,h:n,rgba:r}=mt(Et(t));return ct(e,n,r)}function vt(t='img[loading="lazy"]',{hash:e=!0,hashType:n="blurhash",placeholderSize:r=X,updateSizesOnResize:c=!1,onImageLoad:o}={}){const f=new Set;for(const s of yt(t)){const a=V(s,{updateOnResize:c});if(c&&a&&f.add(a),(typeof __UNLAZY_HASH_DECODING__>"u"||__UNLAZY_HASH_DECODING__)&&e){const d=zt({image:s,hash:typeof e=="string"?e:void 0,hashType:n,size:r});d&&(s.src=d)}if(!s.dataset.src&&!s.dataset.srcset){(typeof __UNLAZY_LOGGING__>"u"||__UNLAZY_LOGGING__)&&console.error("[unlazy] Missing `data-src` or `data-srcset` attribute",s);continue}if(pt||!_t){ft(s),$(s),F(s);continue}if(s.src||(s.src=wt),s.complete&&s.naturalWidth>0){st(s,o);continue}const A=()=>st(s,o);s.addEventListener("load",A,{once:!0}),f.add(()=>s.removeEventListener("load",A))}return()=>{for(const s of f)s();f.clear()}}function st(t,e){var s;if(((s=t.parentElement)==null?void 0:s.tagName.toLowerCase())==="picture"){ft(t),$(t),F(t),e==null||e(t);return}const r=new Image,{srcset:c,src:o,sizes:f}=t.dataset;if(f==="auto"){const a=ut(t);a&&(r.sizes=`${a}px`)}else t.sizes&&(r.sizes=t.sizes);c&&(r.srcset=c),o&&(r.src=o),r.addEventListener("load",()=>{$(t),F(t),e==null||e(t)},{once:!0})}function zt({image:t,hash:e,hashType:n="blurhash",size:r=X,ratio:c}={}){if(!e&&t){const{blurhash:o,thumbhash:f}=t.dataset;e=f||o,n=f?"thumbhash":"blurhash"}if(e)try{if(n==="thumbhash")return Bt(e);if(!c&&t){const o=t.width||t.offsetWidth||r,f=t.height||t.offsetHeight||r;c=o/f}return Ut(e,{ratio:c,size:r})}catch(o){(typeof __UNLAZY_LOGGING__>"u"||__UNLAZY_LOGGING__)&&console.error(`Error generating ${n} placeholder:`,o)}}const W=new WeakMap;function V(t,e){var r;if(t.dataset.sizes!=="auto")return;const n=ut(t);if(n&&(t.sizes=`${n}px`),((r=t.parentElement)==null?void 0:r.tagName.toLowerCase())==="picture"&&!(e!=null&&e.skipChildren)&&[...t.parentElement.getElementsByTagName("source")].forEach(c=>V(c,{skipChildren:!0})),e!=null&&e.updateOnResize){if(!W.has(t)){const c=ht(()=>V(t),500),o=new ResizeObserver(c);W.set(t,o),o.observe(t)}return()=>{const c=W.get(t);c&&(c.disconnect(),W.delete(t))}}}function F(t){t.dataset.src&&(t.src=t.dataset.src,t.removeAttribute("data-src"))}function $(t){t.dataset.srcset&&(t.srcset=t.dataset.srcset,t.removeAttribute("data-srcset"))}function ft(t){const e=t.parentElement;(e==null?void 0:e.tagName.toLowerCase())==="picture"&&([...e.querySelectorAll("source[data-srcset]")].forEach($),[...e.querySelectorAll("source[data-src]")].forEach(F))}function ut(t){var e,n;return t instanceof HTMLSourceElement?(n=(e=t.parentElement)==null?void 0:e.getElementsByTagName("img")[0])==null?void 0:n.offsetWidth:t.offsetWidth}function Pt({src:t,srcSet:e,autoSizes:n,blurhash:r,thumbhash:c,placeholderSrc:o,placeholderSize:f,...s}){const a=rt.useRef(null);return rt.useEffect(()=>{if(!a.current)return;const A=vt(a.current,{hash:c||r,hashType:c?"thumbhash":"blurhash",placeholderSize:f});return()=>{A()}},[t,e,n,r,c,o,f]),At.jsx("img",{ref:a,src:o,"data-src":t,"data-srcset":e,"data-sizes":n?"auto":void 0,loading:"lazy",...s})}export{Pt as U};
