import{i as f,t as g,b2 as u,b3 as C,b4 as w,r as N,j as e,X as R,b5 as $,u as k,b6 as S,an as p,C as y,B as I,b7 as T,m as _,k as A}from"./index-Dr9ZTIop.js";import{L as E}from"./LittleHeader-XNWv_M-9.js";import{I as G,_ as v}from"./index-CPykWLTA.js";import{d as M,C as P}from"./ckeditor-gCzDPHbr.js";document.title="View Students Grades";const B=({props:a,el:c})=>{var r,m;const{gradeData:n}=S(a==null?void 0:a._id),{schoolInfo:i}=p(a==null?void 0:a.schoolIDs),{state:l}=u("JSS 1A");w(l==null?void 0:l._id);let s=(m=(r=n==null?void 0:n.reportCard.find(d=>{var t,x;return d.classInfo===`${a==null?void 0:a.classAssigned} session: ${(t=i[0])==null?void 0:t.year}(${(x=i[0])==null?void 0:x.presentTerm})`}))==null?void 0:r.result)==null?void 0:m.find(d=>d.subject===(c==null?void 0:c.subjectTitle));return e.jsxs("div",{className:"w-[260px] border-r-2 border-blue-950 ",children:[e.jsx("div",{children:e.jsxs("div",{className:"w-[260px] ",children:[e.jsx("p",{className:"pl-1 font-bold text-[12px]",children:s!=null&&s.subject?s==null?void 0:s.subject:"Have't Entered"}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[10px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:"1st"}),e.jsx("p",{className:"w-[30px] border-r",children:"2nd"}),e.jsx("p",{className:"w-[30px] border-r",children:"3rd"}),e.jsx("p",{className:"w-[30px] border-r",children:"4th"}),e.jsx("p",{className:"w-[35px] border-r",children:"Exam"}),e.jsx("p",{className:"w-[35px] ",children:"Total"}),e.jsx("p",{className:"w-[35px] ",children:"Grade"})]})]})}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[12px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test1?s==null?void 0:s.test1:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test2?s==null?void 0:s.test2:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test3?s==null?void 0:s.test3:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test4?s==null?void 0:s.test4:0}),e.jsx("p",{className:"w-[35px] border-r",children:s!=null&&s.exam?s==null?void 0:s.exam:0}),e.jsx("p",{className:"w-[35px] font-bold border-r",children:s!=null&&s.mark?s==null?void 0:s.mark:0}),e.jsx("p",{className:"w-[35px] font-bold",children:s!=null&&s.grade?s==null?void 0:s.grade:"Nill"})]})]})},V=({props:a,i:c})=>{var b;const{classID:n}=f(),{data:i}=k(),{gradeData:l}=S(a==null?void 0:a._id),{oneClass:s}=g(n),{subjectData:r}=w(s==null?void 0:s._id);C(s==null?void 0:s._id);const{schoolInfo:m}=p(a==null?void 0:a.schoolIDs);let d=l==null?void 0:l.reportCard.find(o=>{var h,j;return o.classInfo===`${a==null?void 0:a.classAssigned} session: ${(h=m[0])==null?void 0:h.year}(${(j=m[0])==null?void 0:j.presentTerm})`});const[t,x]=N.useState(`${d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:""}`);return e.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-28 px-4 my-2  overflow-hidden ${c%2===0?"bg-slate-50":"bg-white"}`,children:[e.jsx("div",{className:"w-[100px] border-r font-bold",children:c+1}),e.jsx("div",{className:"w-[250px] flex border-r",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:a!=null&&a.avatar?a==null?void 0:a.avatar:y}),e.jsxs("div",{className:"w-[180px] ",children:[" ",a==null?void 0:a.studentFirstName," ",a==null?void 0:a.studentLastName]})]})}),e.jsx("div",{className:"w-[100px] border-r",children:e.jsx(z,{props:a})}),e.jsx("div",{className:`w-[${(r==null?void 0:r.classSubjects.length)*260}px]  border-r items-center flex`,children:e.jsx("div",{className:"flex gap-4 ",children:(b=R.sortBy(r==null?void 0:r.classSubjects,"subjectTitle"))==null?void 0:b.map(o=>e.jsx(B,{props:a,el:o}))})}),e.jsx("div",{className:"w-[100px] border-r",children:d==null?void 0:d.points}),e.jsx("div",{className:"w-[100px] border-r",children:d==null?void 0:d.grade}),e.jsx("div",{className:"w-[300px] border-r",children:d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:"No Comment Yet"}),e.jsx("div",{className:"w-[300px] border-r",children:e.jsx("textarea",{className:"border rounded-sm w-[94%] p-1 text-[12px] h-14 resize-none mx-2",placeholder:`${d!=null&&d.adminComment?d==null?void 0:d.adminComment:"Give a Remark"} `,defaultValue:d!=null&&d.adminComment?d==null?void 0:d.adminComment:"",value:t,onChange:o=>{x(o.target.value)}})}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx(I,{name:d!=null&&d.adminComment?"Update Comment":"Add Comment",className:`pl-4 py-3 w-[85%]  text-white ${d!=null&&d.adminComment?"bg-black hover:bg-neutral-800 ":"bg-red-500 hover:bg-red-600 "} transition-all duration-300`,onClick:()=>{t!==""?T(i==null?void 0:i._id,a==null?void 0:a._id,t).then(o=>{var h,j;console.log(o),o.status===201?(_(`api/student-report-card/${a==null?void 0:a._id}`),v.success("Report Card Report Noted")):v.error(`${(j=(h=o==null?void 0:o.response)==null?void 0:h.data)==null?void 0:j.message}`)}):v.error("Please give a REMARK")}})}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx("p",{className:"w-[35px] ",children:"Approve"})})]})},z=({props:a})=>{var n,i,l,s,r,m,d,t;const{mainStudentAttendance:c}=A(a==null?void 0:a._id);return e.jsx("div",{children:((i=(n=c==null?void 0:c.data)==null?void 0:n.attendance)==null?void 0:i.filter(x=>x.present===!0).length)/((s=(l=c==null?void 0:c.data)==null?void 0:l.attendance)==null?void 0:s.length)*100?e.jsxs("div",{children:[(((m=(r=c==null?void 0:c.data)==null?void 0:r.attendance)==null?void 0:m.filter(x=>x.present===!0).length)/((t=(d=c==null?void 0:c.data)==null?void 0:d.attendance)==null?void 0:t.length)*100).toFixed(2),"%"]}):e.jsx("p",{children:"0%"})})},L=({props:a})=>e.jsx("div",{className:"w-[260px] border-r ",children:e.jsx("p",{children:"Subject Offered"})}),K=()=>{var r,m,d;const{classID:a}=f(),{oneClass:c}=g(a);u(c==null?void 0:c.className);const{classStudents:n}=C(c==null?void 0:c._id),{subjectData:i}=w(c==null?void 0:c._id);N.useState([]);const[l,s]=N.useState("");return e.jsxs("div",{className:"",children:[e.jsx(G,{position:"top-center",reverseOrder:!0}),e.jsx("div",{className:"mb-0"}),e.jsx(E,{name:"Admin's Remark and Approval"}),e.jsx("div",{className:"mt-10"}),e.jsx("div",{className:"flex w-full justify-end"}),e.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[e.jsxs("div",{className:"text-[gray] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",style:{width:`${1700+(i==null?void 0:i.classSubjects.length)*260}px`},children:[e.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),e.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),e.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),e.jsx("div",{className:`w-[${(i==null?void 0:i.classSubjects.length)*260}px] border-r`,children:e.jsx("div",{className:" flex ",children:e.jsx("div",{className:"flex gap-4",children:(r=R.sortBy(i==null?void 0:i.classSubjects,"subjectTitle"))==null?void 0:r.map(t=>e.jsx(L,{props:t}))})})}),e.jsx("div",{className:"w-[100px] border-r",children:"Total Points"}),e.jsx("div",{className:"w-[100px] border-r",children:"Grade"}),e.jsx("div",{className:"w-[300px] border-r",children:"Class Teacher's Comment"}),e.jsx("div",{className:"w-[300px] border-r",children:"Give Report/Remark"}),e.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"}),e.jsx("div",{className:"w-[180px] border-r",children:e.jsx("p",{className:"w-[35px] ",children:"Approve"})})]}),e.jsx("div",{className:" overflow-hidden",style:{width:`${1700+(i==null?void 0:i.classSubjects.length)*260}px`},children:((m=n==null?void 0:n.students)==null?void 0:m.length)>0?e.jsx("div",{children:(d=n==null?void 0:n.students)==null?void 0:d.map((t,x)=>e.jsx("div",{children:e.jsx(V,{props:t,i:x})},t))}):e.jsx("div",{children:"No student yet"})})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("p",{className:"text-blue-800 mt-0 font-[500] text-[30px] capitalize",children:"General Class Remark"}),e.jsx("p",{className:"mt-5 mb-2",children:"Please Give a general class remark to approve this result"}),e.jsx("div",{className:"w-full h-[300px] border rounded-md resize-none p-2",children:e.jsx(M.CKEditor,{editor:P,onChange:(t,x)=>{const b=x.getData();s(b)}})}),l?e.jsx("button",{className:"btn btn-wide bg-blue-950 text-white mt-3 hover:bg-blue-900",onClick:()=>{$(a,l).then(t=>{t.status===200&&v.success("Result will be Published in a minute time")})},children:"Result Approved"}):e.jsx("button",{className:"btn btn-wide bg-blue-950 text-white mt-3 hover:bg-blue-900",children:"Input Remark and Result Approved"})]})]})};export{K as default};
