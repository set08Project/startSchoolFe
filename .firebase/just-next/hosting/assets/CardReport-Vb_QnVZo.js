import{b8 as f,r as w,t as g,b3 as $,b4 as C,j as e,X as R,b6 as u,an as T,C as y,B as S,_,c6 as k,m as p,k as G}from"./index-Dr9ZTIop.js";import{L as I}from"./LittleHeader-XNWv_M-9.js";import{I as A,_ as v}from"./index-CPykWLTA.js";document.title="View Students Grades";const E=({props:a,el:r})=>{var c,m;const{gradeData:t}=u(a==null?void 0:a._id),{schoolInfo:i}=T(a==null?void 0:a.schoolIDs);let s=(m=(c=t==null?void 0:t.reportCard.find(n=>{var o,d;return n.classInfo===`${a==null?void 0:a.classAssigned} session: ${(o=i[0])==null?void 0:o.year}(${(d=i[0])==null?void 0:d.presentTerm})`}))==null?void 0:c.result)==null?void 0:m.find(n=>n.subject===(r==null?void 0:r.subjectTitle));return e.jsxs("div",{className:"w-[260px] border-r-2 border-blue-950 ",children:[e.jsxs("div",{className:"w-[260px] border-",children:[e.jsx("p",{className:"pl-1 font-bold text-[15px]  ",children:s!=null&&s.subject?s==null?void 0:s.subject:"Have't Entered"}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[10px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:"1st"}),e.jsx("p",{className:"w-[30px] border-r",children:"2nd"}),e.jsx("p",{className:"w-[30px] border-r",children:"3rd"}),e.jsx("p",{className:"w-[30px] border-r",children:"4th"}),e.jsx("p",{className:"w-[35px] border-r",children:"Exam"}),e.jsx("p",{className:"w-[35px] ",children:"Total"}),e.jsx("p",{className:"w-[35px] ",children:"Grade"})]})]}),e.jsxs("div",{className:"pl-1 flex gap-1 mt-2 text-[12px] ",children:[e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test1?s==null?void 0:s.test1:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test2?s==null?void 0:s.test2:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test3?s==null?void 0:s.test3:0}),e.jsx("p",{className:"w-[30px] border-r",children:s!=null&&s.test4?s==null?void 0:s.test4:0}),e.jsx("p",{className:"w-[35px] border-r",children:s!=null&&s.exam?s==null?void 0:s.exam:0}),e.jsx("p",{className:"w-[35px] font-bold border-r",children:s!=null&&s.mark?s==null?void 0:s.mark:0}),e.jsx("p",{className:"w-[35px] font-bold",children:s!=null&&s.grade?s==null?void 0:s.grade:"Nill"})]})]})},L=({props:a,i:r})=>{var l;const{teacherInfo:t}=f(),{gradeData:i}=u(a==null?void 0:a._id),{oneClass:s}=g(t==null?void 0:t.presentClassID),{subjectData:c}=C(s==null?void 0:s._id),{schoolInfo:m}=T(a==null?void 0:a.schoolIDs),[n,o]=w.useState(!1);let d=i==null?void 0:i.reportCard.find(x=>{var j,b;return x.classInfo===`${a==null?void 0:a.classAssigned} session: ${(j=m[0])==null?void 0:j.year}(${(b=m[0])==null?void 0:b.presentTerm})`});const[h,N]=w.useState(`${d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:""}`);return e.jsxs("div",{className:`w-full flex items-center gap-2 text-[12px] font-medium  h-28 px-4 my-2  overflow-hidden ${r%2===0?"bg-slate-50":"bg-white"}`,children:[e.jsx("div",{className:"w-[100px] border-r font-bold",children:r+1}),e.jsx("div",{className:"w-[250px] flex border-r",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("img",{className:" mask mask-squircle w-14 h-14 rounded-md border object-cover",src:y}),e.jsxs("div",{className:"w-[180px] ",children:[" ",a==null?void 0:a.studentFirstName," ",a==null?void 0:a.studentLastName]})]})}),e.jsx("div",{className:"w-[100px] border-r",children:e.jsx(B,{props:a})}),e.jsx("div",{className:`w-[${(c==null?void 0:c.classSubjects.length)*260}px]  border-r items-center flex`,children:e.jsx("div",{className:"flex gap-4 ",children:(l=R.sortBy(c==null?void 0:c.classSubjects,"subjectTitle"))==null?void 0:l.map(x=>e.jsx(E,{props:a,el:x}))})}),e.jsx("div",{className:"w-[100px] border-r",children:d==null?void 0:d.points}),e.jsx("div",{className:"w-[100px] border-r",children:d==null?void 0:d.grade}),e.jsx("div",{className:"w-[300px] border-r",children:e.jsx("textarea",{className:"border rounded-sm w-[94%] p-1 text-[12px] h-14 resize-none mx-2",placeholder:`${d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:"Give a Remark"} `,defaultValue:d!=null&&d.classTeacherComment?d==null?void 0:d.classTeacherComment:"",value:h,onChange:x=>{N(x.target.value)}})}),e.jsx("div",{className:"w-[180px] border-r relative",children:e.jsx(S,{name:d!=null&&d.classTeacherComment?"Update Comment":n?"Loading":"Add Comment",icon:n&&e.jsx(_,{color:"white",size:20,className:"absolute left-7 top-5"}),className:`pl-4 py-3 w-[85%]  text-white ${d!=null&&d.classTeacherComment?"bg-black hover:bg-neutral-800 ":"bg-red-500 hover:bg-red-600 "} transition-all duration-300`,onClick:()=>{o(!0),h!==""?k(t==null?void 0:t._id,a==null?void 0:a._id,{teacherComment:h}).then(x=>{var j,b;o(!1),x.status===201?(p(`api/student-report-card/${a==null?void 0:a._id}`),v.success("Report Card Report Noted")):v.error(`${(b=(j=x==null?void 0:x.response)==null?void 0:j.data)==null?void 0:b.message}`)}):v.error("Please give a REMARK")}})})]})},B=({props:a})=>{var t,i,s,c,m,n,o,d;const{mainStudentAttendance:r}=G(a==null?void 0:a._id);return e.jsx("div",{children:((i=(t=r==null?void 0:r.data)==null?void 0:t.attendance)==null?void 0:i.filter(h=>h.present===!0).length)/((c=(s=r==null?void 0:r.data)==null?void 0:s.attendance)==null?void 0:c.length)*100?e.jsxs("div",{children:[(((n=(m=r==null?void 0:r.data)==null?void 0:m.attendance)==null?void 0:n.filter(h=>h.present===!0).length)/((d=(o=r==null?void 0:r.data)==null?void 0:o.attendance)==null?void 0:d.length)*100).toFixed(2),"%"]}):e.jsx("p",{children:"0%"})})},V=({props:a})=>e.jsx("div",{className:"w-[260px] border-r ",children:"subject Offered"}),z=()=>{var m,n,o,d,h,N;const{teacherInfo:a}=f(),[r,t]=w.useState((m=a==null?void 0:a.classesAssigned[0])==null?void 0:m.classID),{oneClass:i}=g(r),{classStudents:s}=$(i==null?void 0:i._id),{subjectData:c}=C(i==null?void 0:i._id);return e.jsxs("div",{className:"",children:[e.jsx(A,{position:"top-center",reverseOrder:!0}),e.jsx("div",{className:"mb-0"}),e.jsx(I,{name:"Class Teacher Remark"}),e.jsxs("div",{className:"mt-10",children:[e.jsx("div",{className:"text-[12px] font-semibold",children:"Report Record for"}),e.jsx("select",{className:"select select-bordered  w-full max-w-xs mb-10 mt-2",value:r,onChange:l=>{t(l.target.value)},children:((n=a==null?void 0:a.classesAssigned)==null?void 0:n.length)>0?(o=a==null?void 0:a.classesAssigned)==null?void 0:o.map(l=>e.jsx("option",{value:l==null?void 0:l.classID,children:l==null?void 0:l.className})):e.jsx("option",{value:"No class Assigned yet",className:"text-black",children:"No class Assigned yet"})})]}),e.jsx("div",{className:"flex w-full justify-end"}),e.jsxs("div",{className:"py-6 px-2 border rounded-md min-w-[300px] overflow-y-hidden ",children:[e.jsxs("div",{className:"text-[gray] flex  gap-2 text-[12px] font-medium uppercase mb-10 px-4",style:{width:`${1200+(c==null?void 0:c.classSubjects.length)*260}px`},children:[e.jsx("div",{className:"w-[100px] border-r",children:"Sequence"}),e.jsx("div",{className:"w-[250px] border-r",children:"student Info"}),e.jsx("div",{className:"w-[100px] border-r",children:"Student's Attendance Ratio"}),e.jsx("div",{className:`w-[${(c==null?void 0:c.classSubjects.length)*260}px] border-r`,children:e.jsx("div",{className:" flex ",children:e.jsx("div",{className:"flex gap-4",children:(d=R.sortBy(c==null?void 0:c.classSubjects,"subjectTitle"))==null?void 0:d.map(l=>e.jsx(V,{props:l}))})})}),e.jsx("div",{className:"w-[100px] border-r",children:"Total Points"}),e.jsx("div",{className:"w-[100px] border-r",children:"Grade"}),e.jsx("div",{className:"w-[300px] border-r",children:"Give Report/Remark"}),e.jsx("div",{className:"w-[180px] border-r",children:"Submit Report"})]}),e.jsx("div",{className:" overflow-hidden",style:{width:`${1200+(c==null?void 0:c.classSubjects.length)*260}px`},children:((h=s==null?void 0:s.students)==null?void 0:h.length)>0?e.jsx("div",{children:(N=s==null?void 0:s.students)==null?void 0:N.map((l,x)=>e.jsx("div",{children:e.jsx(L,{props:l,i:x})},l))}):e.jsx("div",{children:"No student yet"})})]})]})};export{z as default};
